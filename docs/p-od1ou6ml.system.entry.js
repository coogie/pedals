var __awaiter=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))(function(o,a){function r(e){try{l(i.next(e))}catch(e){a(e)}}function s(e){try{l(i["throw"](e))}catch(e){a(e)}}function l(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(r,s)}l((i=i.apply(e,t||[])).next())})};var __generator=this&&this.__generator||function(e,t){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},i,o,a,r;return r={next:s(0),throw:s(1),return:s(2)},typeof Symbol==="function"&&(r[Symbol.iterator]=function(){return this}),r;function s(e){return function(t){return l([e,t])}}function l(r){if(i)throw new TypeError("Generator is already executing.");while(n)try{if(i=1,o&&(a=r[0]&2?o["return"]:r[0]?o["throw"]||((a=o["return"])&&a.call(o),0):o.next)&&!(a=a.call(o,r[1])).done)return a;if(o=0,a)r=[r[0]&2,a.value];switch(r[0]){case 0:case 1:a=r;break;case 4:n.label++;return{value:r[1],done:false};case 5:n.label++;o=r[1];r=[0];continue;case 7:r=n.ops.pop();n.trys.pop();continue;default:if(!(a=n.trys,a=a.length>0&&a[a.length-1])&&(r[0]===6||r[0]===2)){n=0;continue}if(r[0]===3&&(!a||r[1]>a[0]&&r[1]<a[3])){n.label=r[1];break}if(r[0]===6&&n.label<a[1]){n.label=a[1];a=r;break}if(a&&n.label<a[2]){n.label=a[2];n.ops.push(r);break}if(a[2])n.ops.pop();n.trys.pop();continue}r=t.call(e,n)}catch(e){r=[6,e];o=0}finally{i=a=0}if(r[0]&5)throw r[1];return{value:r[0]?r[1]:void 0,done:true}}};System.register(["./p-a981be9c.system.js"],function(e){"use strict";var t,n,i,o,a;return{setters:[function(e){t=e.r;n=e.h;i=e.H;o=e.g;a=e.c}],execute:function(){var r=function(){function e(e){t(this,e)}e.prototype.render=function(){return n("div",{class:"app-home"},n("board-oscilloscope",null,n("pedal-board",null)))};Object.defineProperty(e,"style",{get:function(){return".app-home{padding:10px}button{background:#5851ff;color:#fff;margin:8px;border:none;font-size:13px;font-weight:700;text-transform:uppercase;padding:16px 20px;border-radius:2px;-webkit-box-shadow:0 8px 16px rgba(0,0,0,.1),0 3px 6px rgba(0,0,0,.08);box-shadow:0 8px 16px rgba(0,0,0,.1),0 3px 6px rgba(0,0,0,.08);outline:0;letter-spacing:.04em;-webkit-transition:all .15s ease;transition:all .15s ease;cursor:pointer}button:hover{-webkit-box-shadow:0 3px 6px rgba(0,0,0,.1),0 1px 3px rgba(0,0,0,.1);box-shadow:0 3px 6px rgba(0,0,0,.1),0 1px 3px rgba(0,0,0,.1);-webkit-transform:translateY(1px);transform:translateY(1px)}"},enumerable:true,configurable:true});return e}();e("app_home",r);var s=function e(t,n){if(n===void 0)n={};if(!(t instanceof window.AudioNode)){throw new Error("Oscilloscope source must be an AudioNode")}if(t instanceof window.AnalyserNode){this.analyser=t}else{this.analyser=t.context.createAnalyser();t.connect(this.analyser)}if(n.fftSize){this.analyser.fftSize=n.fftSize}this.timeDomain=new Uint8Array(this.analyser.frequencyBinCount);this.drawRequest=0};s.prototype.animate=function e(t,n,i,o,a){var r=this;if(this.drawRequest){throw new Error("Oscilloscope animation is already running")}this.ctx=t;var s=function(){t.clearRect(0,0,t.canvas.width,t.canvas.height);r.draw(t,n,i,o,a);r.drawRequest=window.requestAnimationFrame(s)};s()};s.prototype.stop=function e(){if(this.drawRequest){window.cancelAnimationFrame(this.drawRequest);this.drawRequest=0;this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}};s.prototype.draw=function e(t,n,i,o,a){var r=this;if(n===void 0)n=0;if(i===void 0)i=0;if(o===void 0)o=t.canvas.width-n;if(a===void 0)a=t.canvas.height-i;this.analyser.getByteTimeDomainData(this.timeDomain);var s=o/this.timeDomain.length;t.beginPath();for(var l=0;l<this.timeDomain.length;l+=2){var u=r.timeDomain[l]/256;var c=n+l*s;var d=i+a*u;t.lineTo(c,d)}t.stroke()};var l={context:new AudioContext({latencyHint:"playback"}),sources:[],pedals:[],lastInLine:null,toggleOnOff:function(e,t){return function(n){var i=n===undefined?!!e.gain.value:n;if(i){t.gain.value=1;e.gain.value=0}else{t.gain.value=0;e.gain.value=1}}},createSwitch:function(e,t,n){if(n===void 0){n=false}var i=this.context.createGain();var o=this.context.createGain();var a=this.context.createGain();var r=this.toggleOnOff(i,o);r(n);e.connect(i);t.connect(o);i.connect(a);o.connect(a);return[a,r]},addPedal:function(e){this.pedals.push(e)},sealPedalBoard:function(){var e=this.context.createGain();for(var t=0,n=this.sources;t<n.length;t++){var i=n[t];var o=void 0;var a=i.constructor.name;if(a==="HTMLAudioElement"){o=this.context.createMediaElementSource(i)}if(a==="LocalMediaStream"||a==="MediaStream"){o=this.context.createMediaStreamSource(i)}o.connect(e)}var r=this.pedals.reduce(function(e,t){return t(e)},e);this.lastInLine=r;r.connect(this.context.destination)}};var u=function(){function e(e){t(this,e)}e.prototype.componentDidLoad=function(){var e=l.lastInLine;var t=new s(e);t.animate(this.canvas.getContext("2d"))};e.prototype.render=function(){var e=this;return n(i,null,n("canvas",{class:"board-oscilloscope",ref:function(t){return e.canvas=t}}),n("slot",null))};Object.defineProperty(e,"style",{get:function(){return"canvas{border-top:2px solid red;border-bottom:2px solid red;height:85px;width:100%}"},enumerable:true,configurable:true});return e}();e("board_oscilloscope",u);var c=function(){function e(e){t(this,e);this.playing=false;this.usingLine=false;this.demoFileNodes=[]}e.prototype.componentWillLoad=function(){return __awaiter(this,void 0,void 0,function(){var e,t,n,i,o,a,r,s,u;return __generator(this,function(c){switch(c.label){case 0:e=["FloatingRotary","NoFear","OrangeDrive","TheSeventies","TombComb","VintageCombo"];t=document.createDocumentFragment();for(n=0,i=e;n<i.length;n++){o=i[n];a=document.createElement("audio");a.src="assets/audio/"+o+".mp3";a.id=o;a.loop=true;this.demoFileNodes.push(a);l.sources.push(a)}this.el.appendChild(t);c.label=1;case 1:c.trys.push([1,3,,4]);r={video:false,audio:{echoCancellation:false,noiseSuppression:false,autoGainControl:false}};return[4,navigator.mediaDevices.getUserMedia(r)];case 2:s=c.sent();this.lineNode=s;l.sources.push(s);this.lineNode.getAudioTracks()[0].enabled=false;return[3,4];case 3:u=c.sent();return[3,4];case 4:this.setActiveAudioNode(0);return[2]}})})};e.prototype.setActiveAudioNode=function(e){this.togglePlaying("pause");this.audioNode=this.demoFileNodes[e]};e.prototype.componentDidLoad=function(){l.sealPedalBoard()};e.prototype.togglePlaying=function(e){if(e===void 0){e=null}if(!this.audioNode)return;var t=l.context;if(t.state==="suspended"){t.resume()}if(this.usingLine)this.toggleLineIn("stop");if(e==="play"){this.audioNode.play();this.playing=true;return}if(e==="pause"){this.audioNode.pause();this.playing=false;return}if(!this.playing){this.audioNode.play();this.playing=true;return}if(this.playing){this.audioNode.pause();this.playing=false;return}};e.prototype.toggleLineIn=function(e){if(e===void 0){e=null}var t=this.lineNode.getAudioTracks()[0];if(this.playing)this.togglePlaying("pause");if(e==="stop"){this.usingLine=false;t.enabled=false;return}if(e==="start"){this.usingLine=true;t.enabled=true;return}if(this.usingLine){this.usingLine=false;t.enabled=false;return}if(!this.usingLine){this.usingLine=true;t.enabled=true;return}};e.prototype.render=function(){var e=this;return n("div",{class:"PedalBoard"},n("select",{onChange:function(t){return e.setActiveAudioNode(t.target.value)}},this.demoFileNodes.map(function(e,t){return n("option",{value:t},e.id)})),n("button",{onClick:function(){return e.togglePlaying()}},this.playing?"⏸️":"▶️")," ","|"," ",n("button",{onClick:function(){return e.toggleLineIn()}},this.usingLine?"Stop":"Use"," Line In"),n("div",{class:"PedalBoard__pedals"},n("pedal-chorus",null),n("pedal-boost",null),n("pedal-overdrive",null)))};Object.defineProperty(e.prototype,"el",{get:function(){return o(this)},enumerable:true,configurable:true});Object.defineProperty(e,"style",{get:function(){return".PedalBoard__pedals{display:-ms-flexbox;display:flex}.PedalBoard__pedals>*{border:1px solid;margin:1em}"},enumerable:true,configurable:true});return e}();e("pedal_board",c);var d=function(){function e(e){t(this,e);this.active=false;this.boost=1.5}e.prototype.componentWillLoad=function(){var e=this;l.addPedal(function(t){var n=l.context;var i=n.createGain();var o=n.createGain();var a=l.createSwitch(t,i,e.active),r=a[0],s=a[1];e.toggle=s;e.boostNode=o;e.updateNodeValues();t.connect(o);o.connect(i);return r})};e.prototype.updateNodeValues=function(){this.boostNode.gain.value=this.boost};e.prototype.setKnobValue=function(e){var t=e.detail,n=t.id,i=t.val;if(n==="boost_knob")this.boost=i;this.updateNodeValues()};e.prototype.toggleActive=function(){this.active=!this.active;this.toggle()};e.prototype.render=function(){var e=this;return n("div",{class:"pedal-boost"},n("h1",null,"<pedal-boost>"),n("pedal-knob",{label:"Boost",min:0,max:3,value:this.boost,onRotate:function(t){return e.setKnobValue(t)}}),n("pedal-stomp",{isActive:this.active,onStomp:function(){return e.toggleActive()}}))};Object.defineProperty(e,"style",{get:function(){return""},enumerable:true,configurable:true});return e}();e("pedal_boost",d);var p=function(){function e(e){t(this,e);this.active=false;this.speed=1;this.delay=.03;this.depth=.25}e.prototype.componentWillLoad=function(){var e=this;l.addPedal(function(t){var n=l.context;var i=n.createGain();var o=n.createGain();e.delayNode1=n.createDelay();e.delayNode2=n.createDelay();e.delayNode3=n.createDelay();e.delaySum=n.createGain();e.oscillator=n.createOscillator();var a=l.createSwitch(t,i,e.active),r=a[0],s=a[1];e.toggle=s;e.updateNodeValues();t.connect(o);e.oscillator.connect(o);o.connect(e.delayNode1);o.connect(e.delayNode2);o.connect(e.delayNode3);e.delayNode1.connect(e.delaySum);e.delayNode2.connect(e.delaySum);e.delayNode3.connect(e.delaySum);e.delaySum.connect(i);t.connect(i);e.oscillator.start(0);return r})};e.prototype.updateNodeValues=function(){this.delayNode1.delayTime.value=this.delay;this.delayNode2.delayTime.value=this.delay*1.1;this.delayNode3.delayTime.value=this.delay*1.25;this.delaySum.gain.value=this.depth;this.oscillator.frequency.value=this.speed};e.prototype.setKnobValue=function(e){var t=e.detail,n=t.id,i=t.val;if(n==="speed_knob")this.speed=i;if(n==="delay_knob")this.delay=i;if(n==="depth_knob")this.depth=i;this.updateNodeValues()};e.prototype.toggleActive=function(){this.active=!this.active;this.toggle()};e.prototype.render=function(){var e=this;return n("div",{class:"pedal-chorus"},n("h1",null,"<pedal-chorus>"),n("pedal-knob",{label:"Speed",min:.2,max:3,value:this.speed,onRotate:function(t){return e.setKnobValue(t)}}),n("pedal-knob",{label:"Delay",min:.005,max:.075,value:this.delay,onRotate:function(t){return e.setKnobValue(t)}}),n("pedal-knob",{label:"Depth",min:.05,max:.25,value:this.depth,onRotate:function(t){return e.setKnobValue(t)}}),n("pedal-stomp",{isActive:this.active,onStomp:function(){return e.toggleActive()}}))};Object.defineProperty(e,"style",{get:function(){return""},enumerable:true,configurable:true});return e}();e("pedal_chorus",p);var h=function(){function e(e){t(this,e);this.max=1;this.min=0;this.step="any";this.value=0;this.rotate=a(this,"rotate",7)}e.prototype.inputHandler=function(e){var t=parseFloat(e.target.value);var n=this.label.toLowerCase()+"_knob";this.rotate.emit({id:n,val:t})};e.prototype.render=function(){var e=this;return n("div",{class:"pedal-knob"},n("label",{htmlFor:"knob"},this.label),n("input",{type:"range",min:this.min,max:this.max,step:this.step,value:this.value,onInput:function(t){return e.inputHandler(t)}}))};Object.defineProperty(e,"style",{get:function(){return""},enumerable:true,configurable:true});return e}();e("pedal_knob",h);var f=function(){function e(e){t(this,e);this.active=false;this.lowPassFreq=5200;this.drive=18}e.prototype.componentWillLoad=function(){var e=this;l.addPedal(function(t){var n=l.context;var i=n.createGain();e.lowPassNode=n.createBiquadFilter();e.overdriveNode=n.createWaveShaper();var o=l.createSwitch(t,i,e.active),a=o[0],r=o[1];e.toggle=r;i.gain.value=1.175;e.overdriveNode.oversample="4x";e.lowPassNode.type="lowpass";e.updateNodeValues();t.connect(e.overdriveNode);e.overdriveNode.connect(e.lowPassNode);e.lowPassNode.connect(i);return a})};e.prototype.makeDistortionCurve=function(e){var t=44100;var n=new Float32Array(t);var i=Math.PI/180;var o=0;var a;for(;o<t;++o){a=o*2/t-1;n[o]=(8+e)*a*18*i/(Math.PI+e*Math.abs(a))}return n};e.prototype.setDriveValue=function(e){var t=parseFloat(e.detail);this.drive=t};e.prototype.updateNodeValues=function(){this.overdriveNode.curve=this.makeDistortionCurve(this.drive);this.lowPassNode.frequency.value=this.lowPassFreq};e.prototype.setKnobValue=function(e){var t=e.detail,n=t.id,i=t.val;if(n==="drive_knob")this.drive=i;if(n==="tone_knob")this.lowPassFreq=i;this.updateNodeValues()};e.prototype.toggleActive=function(){this.active=!this.active;this.toggle()};e.prototype.render=function(){var e=this;return n("div",{class:"pedal-overdrive"},n("h1",null,"<pedal-overdrive>"),n("pedal-knob",{label:"Drive",min:10,max:50,value:this.drive,onRotate:function(t){return e.setKnobValue(t)}}),n("pedal-knob",{label:"Tone",min:3500,max:7500,value:this.lowPassFreq,onRotate:function(t){return e.setKnobValue(t)}}),n("pedal-stomp",{isActive:this.active,onStomp:function(){return e.toggleActive()}}))};Object.defineProperty(e,"style",{get:function(){return""},enumerable:true,configurable:true});return e}();e("pedal_overdrive",f);function v(e,t){return t={exports:{}},e(t,t.exports),t.exports}var y=v(function(e){(function(){var t={}.hasOwnProperty;function n(){var e=[];for(var i=0;i<arguments.length;i++){var o=arguments[i];if(!o)continue;var a=typeof o;if(a==="string"||a==="number"){e.push(o)}else if(Array.isArray(o)&&o.length){var r=n.apply(null,o);if(r){e.push(r)}}else if(a==="object"){for(var s in o){if(t.call(o,s)&&o[s]){e.push(s)}}}}return e.join(" ")}if(e.exports){n.default=n;e.exports=n}else{window.classNames=n}})()});var g=function(){function e(e){t(this,e);this.isActive=false;this.stomp=a(this,"stomp",7)}e.prototype.stompHandler=function(){this.stomp.emit()};e.prototype.render=function(){var e=this;var t=y("PedalStomp",{"PedalStomp--active":this.isActive});return n("div",{class:t},n("div",{class:"PedalStomp__led"}),n("button",{class:"PedalStomp__switch",onClick:function(){return e.stompHandler()}},"Toggle"))};Object.defineProperty(e,"style",{get:function(){return":host{--led:#48b2ee}.PedalStomp__switch{background:#464646;border:0;border-top:1px solid rgba(0,0,0,.15);border-radius:3px;font-size:0;height:120px;position:relative;width:100%}.PedalStomp__switch:after,.PedalStomp__switch:before{border-radius:10px;content:\"\";height:4px;position:absolute;top:15px;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);width:80%}.PedalStomp__switch:before{background:#343434;border-top:1px solid rgba(0,0,0,.25);border-bottom:1px solid hsla(0,0%,100%,.25);border-right:2px solid hsla(0,0%,100%,.25);border-left:2px solid rgba(0,0,0,.25)}.PedalStomp__switch:hover{cursor:pointer}.PedalStomp--active .PedalStomp__switch{background:#fafafa;background:-webkit-gradient(linear,left top,left bottom,from(#424242),color-stop(85%,#252525),to(#020202));background:linear-gradient(180deg,#424242 0,#252525 85%,#020202)}.PedalStomp--active .PedalStomp__switch:before{background:var(--led)}.PedalStomp--active .PedalStomp__switch:after{-webkit-box-shadow:0 -1px 5px var(--led),-1px 0 5px var(--led),1px 0 5px var(--led),0 1px 5px hsla(0,0%,100%,.25);box-shadow:0 -1px 5px var(--led),-1px 0 5px var(--led),1px 0 5px var(--led),0 1px 5px hsla(0,0%,100%,.25);opacity:.25}"},enumerable:true,configurable:true});return e}();e("pedal_stomp",g)}}});